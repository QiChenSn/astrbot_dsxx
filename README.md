# 定时消息插件 (Timed Message Plugin)

这是一个AstrBot插件，支持每天定时在指定群聊发送指定消息。

## 功能特性

- 🕐 **定时发送**: 支持每天在指定时间自动发送消息到指定群聊
- 📝 **消息管理**: 支持添加、删除、查看、启用/禁用定时消息
- 💾 **配置持久化**: 定时消息配置自动保存到本地文件
- 🔄 **实时管理**: 支持动态添加、删除和修改定时消息，无需重启插件

## 安装方法

1. 将插件文件夹复制到AstrBot的 `data/plugins/` 目录下
2. 在AstrBot WebUI的插件管理页面启用该插件
3. 插件会自动创建配置文件 `timed_messages.json`

## 使用方法

### 添加定时消息
```
/add_timed_msg <群号> <时间(HH:MM)> <消息内容>
```

**示例:**
```
/add_timed_msg 123456789 09:00 早上好，新的一天开始了！
/add_timed_msg 987654321 18:00 下班时间到了，大家辛苦了！
```

### 查看所有定时消息
```
/list_timed_msg
```

### 删除定时消息
```
/del_timed_msg <消息ID>
```

**示例:**
```
/del_timed_msg msg_1_1703123456
```

### 启用/禁用定时消息
```
/toggle_timed_msg <消息ID>
```

**示例:**
```
/toggle_timed_msg msg_1_1703123456
```

## 配置说明

插件会在插件目录下自动创建 `timed_messages.json` 配置文件，格式如下：

```json
[
  {
    "id": "msg_1_1703123456",
    "group_id": "123456789",
    "time": "09:00",
    "message": "早上好，新的一天开始了！",
    "enabled": true,
    "created_at": "2023-12-21T09:00:00"
  }
]
```

## 注意事项

1. 时间格式必须为 `HH:MM`（24小时制）
2. 群号必须是有效的QQ群号
3. 插件重启后会自动加载所有配置的定时消息
4. 支持同时配置多个定时消息
5. 消息内容支持纯文本，如需发送图片等复杂消息，请使用AstrBot的其他功能

## 技术实现

- 使用 `asyncio` 实现异步定时任务
- 使用 `datetime` 和 `time` 模块处理时间计算
- 使用JSON文件持久化配置
- 集成AstrBot的QQ平台适配器发送群消息

## 版本信息

- 版本: v1.0.0
- 作者: AstrBot开发者
- 兼容性: AstrBot v3.4.34+

## 支持

[帮助文档](https://astrbot.app)
